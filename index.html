<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Lotto Live Evoluzione Premium</title>

<style>
body{
background:linear-gradient(135deg,#0f2027,#203a43,#2c5364);
font-family:Arial;
color:white;
margin:0;
padding:20px;
}

h1{
text-align:center;
color:orange;
}

.box{
border:2px solid orange;
border-radius:10px;
padding:15px;
margin:15px 0;
background:rgba(0,0,0,0.4);
}

button{
background:orange;
border:none;
padding:6px 10px;
border-radius:5px;
cursor:pointer;
font-weight:bold;
}

#giocatePremium{
border:2px solid gold;
padding:15px;
border-radius:10px;
margin-bottom:20px;
background:rgba(0,0,0,0.6);
}
</style>
</head>

<body>

<h1>ğŸ”¥ Lotto Live Evoluzione Premium ğŸ”¥</h1>

<div id="giocatePremium">
<h2>ğŸ¯ Giocate Attive Premium</h2>
<div id="listaGiocate">Caricamento...</div>
</div>

<div id="contenuto"></div>

<script>

let estrazioniData = {};

fetch("estrazioni.json")
.then(res=>res.json())
.then(data=>{
estrazioniData = data;
avviaSistema();
});

// -------------------------
// AVVIO
// -------------------------

function avviaSistema(){
controllaGiocate();
mostraGiocate();
mostraRuote();
}

// -------------------------
// ANALISI RUOTA
// -------------------------

function analizzaRuota(nome,estrazioni){

let ultime = estrazioni[0];

let conteggio = {};
estrazioni.forEach(e=>{
e.forEach(n=>{
conteggio[n]=(conteggio[n]||0)+1;
});
});

let caldi = Object.entries(conteggio)
.sort((a,b)=>b[1]-a[1])
.slice(0,3)
.map(x=>parseInt(x[0]));

let freddi = Object.entries(conteggio)
.sort((a,b)=>a[1]-b[1])
.slice(0,3)
.map(x=>parseInt(x[0]));

let amboForte = [caldi[0],caldi[1]];

return {ultime,caldi,freddi,amboForte};
}

// -------------------------
// MOSTRA RUOTE
// -------------------------

function mostraRuote(){

let div = document.getElementById("contenuto");
div.innerHTML="";

let ruoteOrdinate = Object.keys(estrazioniData).sort();

ruoteOrdinate.forEach(nome=>{

let stats = analizzaRuota(nome,estrazioniData[nome]);

div.innerHTML+=`
<div class="box">
<h2>${nome}</h2>
<p>Ultima: ${stats.ultime.join(" - ")}</p>
<p>ğŸ”¥ Caldi: ${stats.caldi.join(", ")}</p>
<p>â„ Freddi: ${stats.freddi.join(", ")}</p>
<p>ğŸ¯ Ambo forte: ${stats.amboForte[0]} - ${stats.amboForte[1]}</p>
<button onclick="salvaGiocata('${nome}',${stats.amboForte[0]},${stats.amboForte[1]})">
Salva ambo forte (Auto)
</button>
</div>
`;

});
}

// -------------------------
// MODELLO EVOLUTIVO SEMI-AI
// -------------------------

function salvaGiocata(ruota,n1,n2){

let giocate = JSON.parse(localStorage.getItem("giocate"))||[];
let estrazioni = estrazioniData[ruota];

// Frequenza ultime 100
let freq=0;
estrazioni.slice(0,100).forEach(e=>{
if(e.includes(n1)) freq++;
if(e.includes(n2)) freq++;
});

// Ritardo reale
function calcolaRitardo(numero){
for(let i=0;i<estrazioni.length;i++){
if(estrazioni[i].includes(numero)){
return i;
}
}
return estrazioni.length;
}

let rit1 = calcolaRitardo(n1);
let rit2 = calcolaRitardo(n2);
let ritardo = Math.max(rit1,rit2);

// Indice evolutivo
let indiceForza = (ritardo * 0.6) + ((30 - freq) * 0.4);

// Traduzione in durata
let durata;

if(indiceForza > 20){
durata = 8;
}else if(indiceForza > 12){
durata = 12;
}else{
durata = 16;
}

giocate.push({
ruota:ruota,
num1:n1,
num2:n2,
durata:durata
});

localStorage.setItem("giocate",JSON.stringify(giocate));

controllaGiocate();
mostraGiocate();
}

// -------------------------
// CONTROLLO AUTOMATICO
// -------------------------

function controllaGiocate(){

let giocate = JSON.parse(localStorage.getItem("giocate"))||[];
let nuove=[];

giocate.forEach(g=>{

let estrazioni = estrazioniData[g.ruota];
let controllo = estrazioni.slice(0,g.durata);

let vinta=false;

controllo.forEach(e=>{
if(e.includes(g.num1) && e.includes(g.num2)){
vinta=true;
}
});

if(!vinta){
nuove.push(g);
}

});

localStorage.setItem("giocate",JSON.stringify(nuove));
}

// -------------------------
// MOSTRA GIOCATE
// -------------------------

function mostraGiocate(){

let div = document.getElementById("listaGiocate");
let giocate = JSON.parse(localStorage.getItem("giocate"))||[];

if(giocate.length===0){
div.innerHTML="Nessuna giocata attiva";
return;
}

div.innerHTML="";

giocate.forEach((g,i)=>{

div.innerHTML+=`
<div>
${g.ruota} â†’ ${g.num1}-${g.num2}
(ancora ${g.durata} estr.)
<button onclick="rimuovi(${i})">X</button>
</div>
`;

});
}

function rimuovi(i){
let giocate = JSON.parse(localStorage.getItem("giocate"))||[];
giocate.splice(i,1);
localStorage.setItem("giocate",JSON.stringify(giocate));
mostraGiocate();
}

</script>
</body>
</html>
