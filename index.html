<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<title>Lotto Live Statistiche</title>

<style>
body {
    background: #0f172a;
    color: white;
    font-family: Arial, sans-serif;
    margin: 20px;
}

h1 {
    color: orange;
    text-align: center;
}

.card {
    background: #1e293b;
    padding: 20px;
    margin-bottom: 20px;
    border-radius: 12px;
    border: 2px solid #334155;
}

.ruota-forte {
    border: 2px solid gold;
}

button {
    background: orange;
    border: none;
    padding: 6px 12px;
    border-radius: 6px;
    cursor: pointer;
    font-weight: bold;
    margin-top: 5px;
}

button:hover {
    background: gold;
}

.premium-box {
    background: #111;
    padding: 20px;
    border-radius: 12px;
    border: 2px solid gold;
    margin-top: 30px;
}
</style>
</head>

<body>

<h1>ðŸ”¥ Lotto Live Statistiche ðŸ”¥</h1>

<div id="contenuto"></div>

<hr style="margin:40px 0; border:2px solid orange;">

<div class="premium-box">
    <h2 style="color:gold;">ðŸŽ¯ Giocate Attive Premium</h2>
    <div id="listaGiocate"></div>
</div>

<script>

const API_URL = "https://lotto-statistiche.onrender.com";

function caricaDati() {
    fetch(API_URL + "/api")
    .then(res => res.json())
    .then(data => {

        const container = document.getElementById("contenuto");
        container.innerHTML = "";

        const ruotaForte = data.ruota_forte;

        for (let ruota in data) {

            if (ruota === "ruota_forte") continue;

            const stats = data[ruota];

            let classe = "card";
            if (ruota === ruotaForte) classe += " ruota-forte";

            let ambiHTML = "";

            stats.ambi_forti.forEach(ambo => {
                ambiHTML += `
                    <div>
                        ${ambo[0]} - ${ambo[1]}
                        <button onclick="salvaGiocata(${ambo[0]}, ${ambo[1]}, '${ruota}')">
                            ðŸ’¾ Salva Premium
                        </button>
                    </div>
                `;
            });

            container.innerHTML += `
                <div class="${classe}">
                    <h2>${ruota}</h2>
                    <p><b>Ultima:</b> ${stats.ultima_estrazione.join(", ")}</p>
                    <p><b>Caldi:</b> ${stats.caldi.join(", ")}</p>
                    <p><b>Freddi:</b> ${stats.freddi.join(", ")}</p>
                    <div>${ambiHTML}</div>
                </div>
            `;
        }
    })
    .catch(error => {
        console.error("Errore API:", error);
    });
}

function salvaGiocata(num1, num2, ruota) {
    fetch(API_URL + "/salva_giocata", {
        method: "POST",
        headers: {
            "Content-Type": "application/json"
        },
        body: JSON.stringify({
            num1: num1,
            num2: num2,
            ruota: ruota
        })
    })
    .then(res => res.json())
    .then(data => {
        alert("Giocata salvata!");
        caricaGiocatePremium();
    })
    .catch(error => {
        console.error("Errore salvataggio:", error);
    });
}

function caricaGiocatePremium() {
    fetch(API_URL + "/giocate_attive")
    .then(res => res.json())
    .then(data => {

        const container = document.getElementById("listaGiocate");
        container.innerHTML = "";

        if (!data || data.length === 0) {
            container.innerHTML = "<p>Nessuna giocata attiva</p>";
            return;
        }

        data.forEach(g => {

            container.innerHTML += `
                <div style="
                    margin-bottom:15px;
                    padding:15px;
                    border:2px solid lime;
                    border-radius:8px;
                    background:#1a1a1a;
                ">
                    <strong>${g.ruota}</strong><br>
                    Ambo: ${g.num1} - ${g.num2}<br>
                    Stato: ${g.stato}
                </div>
            `;
        });

    })
    .catch(error => {
        console.error("Errore giocate:", error);
    });
}

caricaDati();
caricaGiocatePremium();

</script>

</body>
</html>
