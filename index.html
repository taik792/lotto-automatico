<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<title>Lotto Live Premium Evoluto</title>
<style>
body { font-family: Arial; background:#111; color:white; text-align:center; }
button { padding:10px 20px; margin:5px; font-size:16px; cursor:pointer; }
.box { background:#1e1e1e; padding:15px; margin:15px auto; width:80%; border-radius:10px; }
.vinta { color:#00ff88; font-weight:bold; }
.persa { color:#ff4444; font-weight:bold; }
</style>
</head>
<body>

<h1>ðŸŽ¯ Lotto Live â€“ Premium Evoluto</h1>

<button onclick="generaPrevisione()">Genera Previsione</button>
<button onclick="simulaEstrazione()">Simula Estrazione</button>

<div class="box" id="previsioneBox"></div>

<hr>

<h2>ðŸ“Š Statistiche Sistema</h2>
<div id="percentualeBox"></div>
<br>
<div id="storicoBox"></div>

<script>

// ===== GENERA PREVISIONE =====

function generaPrevisione() {

    let numeri = [];
    while(numeri.length < 2){
        let n = Math.floor(Math.random()*90)+1;
        if(!numeri.includes(n)) numeri.push(n);
    }

    let predizione = {
        numeri: numeri,
        ruota: "Nazionale",
        durata: 8,
        estrazioniRestanti: 8,
        vinta: false,
        dataInizio: new Date().toISOString()
    };

    localStorage.setItem("predizioneLotto", JSON.stringify(predizione));
    aggiornaUI();
}

// ===== SIMULA ESTRAZIONE =====

function simulaEstrazione(){

    let predizione = JSON.parse(localStorage.getItem("predizioneLotto"));
    if(!predizione) return alert("Genera prima una previsione");

    if(predizione.vinta) return alert("GiÃ  vinta");

    let estratti = [];
    while(estratti.length < 5){
        let n = Math.floor(Math.random()*90)+1;
        if(!estratti.includes(n)) estratti.push(n);
    }

    let colpiti = predizione.numeri.filter(n => estratti.includes(n));

    if(colpiti.length >= 2){
        predizione.vinta = true;
        salvaStorico(predizione);
        alert("ðŸŽ‰ AMBO VINCENTE!");
    } else {
        predizione.estrazioniRestanti--;
        if(predizione.estrazioniRestanti <= 0){
            salvaStorico(predizione);
            evolviSistema(predizione);
        }
    }

    localStorage.setItem("predizioneLotto", JSON.stringify(predizione));
    aggiornaUI();
}

// ===== EVOLUZIONE AUTOMATICA =====

function evolviSistema(predizione){

    if(predizione.vinta) return;

    if(predizione.durata === 8){
        predizione.durata = 12;
    } else if(predizione.durata === 12){
        predizione.durata = 16;
    } else {
        generaPrevisione();
        return;
    }

    predizione.estrazioniRestanti = predizione.durata;
    predizione.dataInizio = new Date().toISOString();

    localStorage.setItem("predizioneLotto", JSON.stringify(predizione));
    alert("ðŸ”„ Sistema evoluto a " + predizione.durata + " estrazioni");
}

// ===== STORICO =====

function salvaStorico(predizione){

    let storico = JSON.parse(localStorage.getItem("storicoLotto")) || [];

    storico.push({
        numeri: predizione.numeri,
        ruota: predizione.ruota,
        durata: predizione.durata,
        esito: predizione.vinta ? "VINTA" : "PERSA",
        data: new Date().toLocaleString()
    });

    localStorage.setItem("storicoLotto", JSON.stringify(storico));
}

// ===== PERCENTUALE =====

function calcolaPercentuale(){

    let storico = JSON.parse(localStorage.getItem("storicoLotto")) || [];
    if(storico.length === 0) return 0;

    let vinte = storico.filter(s => s.esito === "VINTA").length;
    return ((vinte / storico.length) * 100).toFixed(1);
}

// ===== UI =====

function aggiornaUI(){

    let predizione = JSON.parse(localStorage.getItem("predizioneLotto"));
    let box = document.getElementById("previsioneBox");

    if(predizione){
        box.innerHTML = `
        <h3>Previsione Attiva</h3>
        Numeri: ${predizione.numeri.join(", ")}<br>
        Durata: ${predizione.durata} estrazioni<br>
        Restanti: ${predizione.estrazioniRestanti}<br>
        Stato: ${predizione.vinta ? "<span class='vinta'>VINTA</span>" : "<span class='persa'>IN CORSO</span>"}
        `;
    }

    document.getElementById("percentualeBox").innerHTML =
        "Percentuale Successo: " + calcolaPercentuale() + "%";

    mostraStorico();
}

// ===== MOSTRA STORICO =====

function mostraStorico(){

    let storico = JSON.parse(localStorage.getItem("storicoLotto")) || [];
    let box = document.getElementById("storicoBox");

    box.innerHTML = "<h3>Storico Sistema</h3>";

    storico.slice().reverse().forEach(s => {
        box.innerHTML += `
            <div>
                ${s.data} - ${s.ruota} - ${s.numeri.join(", ")} 
                <strong>${s.esito}</strong>
            </div>
        `;
    });
}

aggiornaUI();

</script>
</body>
</html>
