<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<title>Lotto Live Statistiche Premium</title>

<style>
body{
margin:0;
font-family:Arial;
background:linear-gradient(to bottom,#0f2027,#203a43,#2c5364);
color:white;
}

h1{
text-align:center;
padding:20px;
color:orange;
}

.container{
width:90%;
margin:auto;
}

.ruota{
border:2px solid orange;
border-radius:10px;
padding:15px;
margin:15px 0;
background:rgba(0,0,0,0.4);
}

.premium-box{
border:2px solid gold;
padding:15px;
margin:20px 0;
border-radius:10px;
background:rgba(0,0,0,0.6);
}

button{
background:orange;
border:none;
padding:5px 10px;
cursor:pointer;
border-radius:5px;
margin-top:5px;
}

select{
margin-top:5px;
}
</style>
</head>

<body>

<h1>ğŸ”¥ Lotto Live Statistiche Premium ğŸ”¥</h1>

<div class="container">

<div class="premium-box">
<h2>ğŸ¯ Giocate Attive Premium</h2>
<div id="giocatePremium"></div>
</div>

<div id="ruote"></div>

</div>

<script>

let estrazioniData = {};

fetch("estrazioni.json")
.then(res => res.json())
.then(data => {
estrazioniData = data;
generaRuote();
});

function generaRuote(){

const ordine = ["Bari","Cagliari","Firenze","Genova","Milano","Napoli","Palermo","Roma","Torino","Venezia","Nazionale"];

const container = document.getElementById("ruote");
container.innerHTML="";

ordine.forEach(ruota=>{

if(!estrazioniData[ruota]) return;

let estrazioni = estrazioniData[ruota];
let ultima = estrazioni[0];

let stats = calcolaStatistiche(estrazioni);

let div = document.createElement("div");
div.className="ruota";

div.innerHTML=`
<h3>${ruota}</h3>
<p><b>Ultima:</b> ${ultima.join(" - ")}</p>

<p><b>ğŸ”¥ Caldi:</b> ${stats.caldi.join(", ")}</p>
<p><b>â„ Freddi:</b> ${stats.freddi.join(", ")}</p>
<p><b>â³ Ritardo max:</b> ${stats.ritardo}</p>
<p><b>ğŸ¯ Ambo forte:</b> ${stats.ambo[0]} - ${stats.ambo[1]}</p>

<select id="estrazioni_${ruota}">
<option value="5">5 estrazioni</option>
<option value="10">10 estrazioni</option>
<option value="15">15 estrazioni</option>
<option value="20">20 estrazioni</option>
</select>

<br>

<button onclick="salvaGiocata('${ruota}',${stats.ambo[0]},${stats.ambo[1]})">
Salva ambo forte
</button>
`;

container.appendChild(div);

});

mostraGiocate();
}

function calcolaStatistiche(lista){

let freq = {};
let ultimi100 = lista.slice(0,100);

ultimi100.forEach(estr=>{
estr.forEach(n=>{
freq[n]=(freq[n]||0)+1;
});
});

let numeri = Object.keys(freq).map(n=>({n:parseInt(n),f:freq[n]}));

numeri.sort((a,b)=>b.f-a.f);
let caldi = numeri.slice(0,3).map(x=>x.n);

numeri.sort((a,b)=>a.f-b.f);
let freddi = numeri.slice(0,3).map(x=>x.n);

let ritardo = freddi[0];

return{
caldi:caldi,
freddi:freddi,
ritardo:ritardo,
ambo:[caldi[0],caldi[1]]
};
}

function salvaGiocata(ruota,n1,n2){

let giocate = JSON.parse(localStorage.getItem("giocate"))||[];

let selettore = document.getElementById("estrazioni_"+ruota);
let durata = parseInt(selettore.value);

giocate.push({
ruota:ruota,
num1:n1,
num2:n2,
restanti:durata
});

localStorage.setItem("giocate",JSON.stringify(giocate));

mostraGiocate();
}

function mostraGiocate(){

let box = document.getElementById("giocatePremium");
let giocate = JSON.parse(localStorage.getItem("giocate"))||[];

if(giocate.length===0){
box.innerHTML="Nessuna giocata attiva";
return;
}

box.innerHTML="";

giocate.forEach((g,i)=>{
box.innerHTML+=`
<div>
${g.ruota} â†’ ${g.num1}-${g.num2} 
(ancora ${g.restanti} estr.)
<button onclick="rimuoviGiocata(${i})">X</button>
</div>
`;
});
}

function rimuoviGiocata(i){
let giocate = JSON.parse(localStorage.getItem("giocate"))||[];
giocate.splice(i,1);
localStorage.setItem("giocate",JSON.stringify(giocate));
mostraGiocate();
}

</script>

</body>
</html>
