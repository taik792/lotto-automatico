<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<title>Lotto Evolution LIVE AI PRO</title>

<style>
body{background:#0f1720;color:white;font-family:Arial;}
h1{text-align:center;}
button{
padding:6px 12px;
margin-top:6px;
background:#ff9800;
border:none;
border-radius:6px;
cursor:pointer;
}
.container{width:90%;margin:auto;}
.box{
border:2px solid orange;
border-radius:10px;
padding:15px;
margin:15px 0;
background:#1a2530;
}
.migliore{
border:3px solid gold;
background:#222b36;
}
#giocateAttive{
border:2px solid gold;
padding:10px;
border-radius:10px;
margin-bottom:20px;
}
.stat{margin:4px 0;}
</style>
</head>

<body>

<h1>üî• Lotto Evolution LIVE AI PRO</h1>

<div class="container">

<div id="giocateAttive"></div>
<div id="ruoteContainer"></div>

<h3>üìä Percentuale Sistema</h3>
<div id="percentualeBox">0%</div>

</div>

<script>

let estrazioni = {};
let ordineRuote = [
"Bari","Cagliari","Firenze","Genova","Milano",
"Napoli","Palermo","Roma","Torino","Venezia"
];

fetch("estrazioni.json")
.then(r=>r.json())
.then(data=>{
estrazioni=data;
generaDashboard();
})
.catch(()=>alert("Errore caricamento JSON"));


// ===== ANALISI =====
function analizzaRuota(nome){

let dati=estrazioni[nome];
let ultime=dati.slice(-50);

let conteggio={};
for(let i=1;i<=90;i++) conteggio[i]=0;

ultime.forEach(e=>{
e.forEach(n=>conteggio[n]++);
});

let ordinati=Object.entries(conteggio)
.sort((a,b)=>b[1]-a[1]);

return{
caldi:ordinati.slice(0,3).map(x=>parseInt(x[0])),
freddi:ordinati.slice(-3).map(x=>parseInt(x[0])),
topFreq:ordinati[0][1],
ultima:dati[dati.length-1]
};
}


// ===== CLASSIFICA RUOTE =====
function classificaRuote(){

let classifica=[];

ordineRuote.forEach(r=>{
if(!estrazioni[r]) return;
let a=analizzaRuota(r);
classifica.push({ruota:r,freq:a.topFreq});
});

return classifica.sort((a,b)=>b.freq-a.freq);
}


// ===== DASHBOARD =====
function generaDashboard(){

let container=document.getElementById("ruoteContainer");
container.innerHTML="";

let classifica=classificaRuote();
let migliore=classifica[0].ruota;

ordineRuote.forEach(ruota=>{

if(!estrazioni[ruota]) return;

let a=analizzaRuota(ruota);

let box=document.createElement("div");
box.className="box";
if(ruota===migliore) box.classList.add("migliore");

box.innerHTML=`
<h3>${ruota} ${ruota===migliore?"‚≠ê":""}</h3>
<div class="stat">Ultima: ${a.ultima.join(" - ")}</div>
<div class="stat">üî• Caldi: ${a.caldi.join(", ")}</div>
<div class="stat">‚ùÑ Freddi: ${a.freddi.join(", ")}</div>
<div class="stat">üéØ Ambo Forte: ${a.caldi[0]} - ${a.freddi[0]}</div>
<button onclick="salvaPrevisione('${ruota}')">
Salva ambo forte
</button>
`;

container.appendChild(box);

});

aggiornaGiocateAttive();
}


// ===== CREA PREVISIONE =====
function salvaPrevisione(ruota){

let a=analizzaRuota(ruota);

let previsione={
ruota,
durata:8,
restanti:8,
indice:estrazioni[ruota].length-1,
perdite:0,
strategia:0,
numeri:[a.caldi[0],a.freddi[0]]
};

localStorage.setItem("previsioneAttiva",JSON.stringify(previsione));
aggiornaGiocateAttive();
}


// ===== GIOCATA ATTIVA =====
function aggiornaGiocateAttive(){

let box=document.getElementById("giocateAttive");
let p=JSON.parse(localStorage.getItem("previsioneAttiva"));

if(!p){
box.innerHTML="<strong>Nessuna giocata attiva</strong>";
return;
}

box.innerHTML=`
<strong>üéØ Giocata Attiva</strong><br>
${p.ruota} ‚Üí ${p.numeri.join("-")}
(ancora ${p.restanti})
<button onclick="simulaEstrazione()">Simula</button>
`;
}


// ===== SIMULA LIVE =====
function simulaEstrazione(){

let p=JSON.parse(localStorage.getItem("previsioneAttiva"));
if(!p) return;

let lista=estrazioni[p.ruota];

if(p.indice>=lista.length-1){
alert("Aggiorna il JSON con nuova estrazione");
return;
}

p.indice++;

let estrCorrente=lista[p.indice];

let vinta=p.numeri.every(n=>estrCorrente.includes(n));

p.restanti--;

if(vinta){
alert("üéâ AMBO USCITO!");
salvaStorico(true);
localStorage.removeItem("previsioneAttiva");
}
else if(p.restanti<=0){
evolviSistema(p);
}
else{
localStorage.setItem("previsioneAttiva",JSON.stringify(p));
}

aggiornaGiocateAttive();
aggiornaPercentuale();
}


// ===== EVOLUZIONE AI =====
function evolviSistema(p){

p.perdite++;
p.strategia++;

if(p.strategia>2){

let classifica=classificaRuote();
let nuovaRuota=classifica[1].ruota;

alert("‚ö† Strategia fallita. Cambio automatico su "+nuovaRuota);

let a=analizzaRuota(nuovaRuota);

p.ruota=nuovaRuota;
p.strategia=0;
p.perdite=0;
p.durata=8;
p.restanti=8;
p.indice=estrazioni[nuovaRuota].length-1;
p.numeri=[a.caldi[0],a.freddi[0]];

}
else{

if(p.strategia===1){
let a=analizzaRuota(p.ruota);
p.numeri=[a.caldi[0],a.caldi[1]];
p.durata=12;
p.restanti=12;
}
else if(p.strategia===2){
let a=analizzaRuota(p.ruota);
p.numeri=[a.freddi[0],a.freddi[1]];
p.durata=16;
p.restanti=16;
}

}

localStorage.setItem("previsioneAttiva",JSON.stringify(p));
}


// ===== STORICO =====
function salvaStorico(vinta){

let storico=JSON.parse(localStorage.getItem("storico"))||[];
storico.push({esito:vinta?"VINTA":"PERSA"});
localStorage.setItem("storico",JSON.stringify(storico));
}


// ===== PERCENTUALE =====
function aggiornaPercentuale(){

let storico=JSON.parse(localStorage.getItem("storico"))||[];
let vinte=storico.filter(s=>s.esito==="VINTA").length;
let perc=storico.length?((vinte/storico.length)*100).toFixed(1):0;
document.getElementById("percentualeBox").innerText=perc+"%";
}

aggiornaPercentuale();

</script>

</body>
</html>
