<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<title>Lotto Live</title>
<style>
body { font-family: Arial; background:#0f172a; color:white; padding:20px }
h1 { text-align:center; color:#38bdf8 }
.box { background:#1e293b; padding:15px; margin:15px 0; border-radius:12px }
.badge { padding:4px 8px; margin:2px; border-radius:8px; display:inline-block }
.caldi { background:#dc2626 }
.freddi { background:#2563eb }
.prev { background:#16a34a }
</style>
</head>
<body>

<h1>ðŸ“Š Lotto Live</h1>
<div id="contenuto">Caricamento datiâ€¦</div>

<script>
const RUOTE = [
"Bari","Cagliari","Firenze","Genova","Milano",
"Napoli","Palermo","Roma","Torino","Venezia","Nazionale"
];

// Fonte pubblica JSON di esempio
const URL = "https://api.allorigins.win/raw?url=https://www.superenalotto.it/rest/estrazioni/lotto";

function calcolaStats(estrazioni){
    let freq = {};
    let ritardi = {};
    let ultimo = {};

    estrazioni.forEach((estr,i)=>{
        estr.forEach(n=>{
            freq[n]=(freq[n]||0)+1;
            if(!(n in ultimo)) ultimo[n]=i;
        });
    });

    for(let n=1;n<=90;n++){
        ritardi[n]=(n in ultimo)?ultimo[n]:estrazioni.length;
    }

    return {freq,ritardi};
}

fetch(URL)
.then(r=>r.json())
.then(data=>{
    let html="";
    
    RUOTE.forEach(ruota=>{
        let estrazioni=[];
        
        data.slice(0,5).forEach(e=>{
            if(e.ruote && e.ruote[ruota]){
                estrazioni.push(e.ruote[ruota]);
            }
        });

        if(estrazioni.length===0) return;

        const stats=calcolaStats(estrazioni);

        const caldi=Object.keys(stats.freq)
        .sort((a,b)=>stats.freq[b]-stats.freq[a])
        .slice(0,5);

        const freddi=Object.keys(stats.ritardi)
        .sort((a,b)=>stats.ritardi[b]-stats.ritardi[a])
        .slice(0,5);

        const previsione=[...new Set([...caldi.slice(0,3),...freddi.slice(0,2)])];

        html+=`<div class="box">
        <h2>${ruota}</h2>
        <strong>Ultima:</strong> ${estrazioni[0].join(", ")}<br><br>
        ðŸ”¥ Caldi: ${caldi.map(n=>`<span class="badge caldi">${n}</span>`).join("")}<br><br>
        â„ Freddi: ${freddi.map(n=>`<span class="badge freddi">${n}</span>`).join("")}<br><br>
        ðŸŽ¯ Previsione: ${previsione.map(n=>`<span class="badge prev">${n}</span>`).join("")}
        </div>`;
    });

    document.getElementById("contenuto").innerHTML=html;
})
.catch(()=>{
    document.getElementById("contenuto").innerText="Impossibile caricare dati.";
});
</script>

</body>
</html>


