<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<title>Lotto Live â€“ Premium Evoluto</title>

<style>
body{
    background:#111;
    color:white;
    font-family:Arial;
    text-align:center;
}

button{
    padding:10px 20px;
    margin:10px;
    font-size:16px;
    cursor:pointer;
}

#box{
    margin-top:30px;
    padding:20px;
    background:#222;
    border-radius:10px;
    width:60%;
    margin-left:auto;
    margin-right:auto;
}

#storicoBox{
    margin-top:20px;
    font-size:14px;
}
</style>
</head>

<body>

<h1>ðŸŽ¯ Lotto Live â€“ Premium Evoluto</h1>

<button onclick="generaNuovaPrevisione()">Genera Previsione</button>
<button onclick="simulaEstrazione()">Simula Estrazione</button>

<div id="box">
    <h2>ðŸ“Š Statistiche Sistema</h2>
    <div id="percentualeBox">Percentuale Successo: 0%</div>
    <div id="storicoBox"></div>
</div>

<script>

// ===== CARICAMENTO INIZIALE =====
document.addEventListener("DOMContentLoaded", function () {
    mostraStorico();
    aggiornaPercentuale();
});

// ===== GENERA PREVISIONE =====
function generaNuovaPrevisione() {

    let previsione = {
        numeri: [
            Math.floor(Math.random()*90)+1,
            Math.floor(Math.random()*90)+1
        ],
        ruota: "Bari",
        durata: 8,
        estrazioniRestanti: 8,
        vinta: false
    };

    localStorage.setItem("previsioneAttiva", JSON.stringify(previsione));

    alert("Nuova previsione generata: " + previsione.numeri.join(" - "));
}


// ===== SIMULA ESTRAZIONE =====
function simulaEstrazione() {

    let previsione = JSON.parse(localStorage.getItem("previsioneAttiva"));

    if (!previsione) {
        alert("Genera prima una previsione!");
        return;
    }

    previsione.estrazioniRestanti--;

    // ProbabilitÃ  vincita simulata 20%
    if (Math.random() < 0.2) {
        previsione.vinta = true;
        alert("ðŸŽ‰ AMBO USCITO!");
        salvaStorico(previsione);
        localStorage.removeItem("previsioneAttiva");
    }

    if (!previsione.vinta && previsione.estrazioniRestanti <= 0) {
        salvaStorico(previsione);
        evolviSistema(previsione);
    } else if (!previsione.vinta) {
        localStorage.setItem("previsioneAttiva", JSON.stringify(previsione));
    }

    mostraStorico();
    aggiornaPercentuale();
}


// ===== EVOLUZIONE AUTOMATICA =====
function evolviSistema(predizione) {

    if (predizione.durata === 8) {
        predizione.durata = 12;
    } else if (predizione.durata === 12) {
        predizione.durata = 16;
    } else {
        generaNuovaPrevisione();
        return;
    }

    predizione.estrazioniRestanti = predizione.durata;
    predizione.vinta = false;

    localStorage.setItem("previsioneAttiva", JSON.stringify(predizione));

    alert("Sistema evoluto a durata " + predizione.durata);
}


// ===== SALVA STORICO =====
function salvaStorico(predizione) {

    let storico = JSON.parse(localStorage.getItem("storicoLotto")) || [];

    storico.push({
        numeri: predizione.numeri,
        ruota: predizione.ruota,
        durata: predizione.durata,
        esito: predizione.vinta ? "VINTA" : "PERSA",
        data: new Date().toLocaleString()
    });

    localStorage.setItem("storicoLotto", JSON.stringify(storico));
}


// ===== MOSTRA STORICO =====
function mostraStorico() {

    let storico = JSON.parse(localStorage.getItem("storicoLotto")) || [];
    let box = document.getElementById("storicoBox");

    box.innerHTML = "<h3>Storico Sistema</h3>";

    if (storico.length === 0) {
        box.innerHTML += "<p>Nessuna giocata registrata.</p>";
        return;
    }

    storico.slice().reverse().forEach(s => {
        box.innerHTML += `
            <div style="margin:5px;">
                ${s.data} | ${s.ruota} | ${s.numeri.join(", ")} 
                <strong style="color:${s.esito==="VINTA"?"lime":"red"}">
                ${s.esito}
                </strong>
            </div>
        `;
    });
}


// ===== PERCENTUALE SUCCESSO =====
function aggiornaPercentuale() {

    let storico = JSON.parse(localStorage.getItem("storicoLotto")) || [];

    let vinte = storico.filter(s => s.esito === "VINTA").length;

    let percentuale = storico.length === 0 
        ? 0 
        : ((vinte / storico.length) * 100).toFixed(1);

    document.getElementById("percentualeBox").innerHTML =
        "Percentuale Successo: " + percentuale + "%";
}

</script>

</body>
</html>
