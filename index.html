<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Lotto Live Statistiche</title>

<style>
body {
    margin: 0;
    font-family: Arial, sans-serif;
    background: linear-gradient(to bottom, #0f4c81, #0b3d66);
    color: white;
    text-align: center;
}

h1 {
    padding: 20px;
}

#contenitore {
    padding: 20px;
}

.ruota {
    background: rgba(255,255,255,0.05);
    margin: 20px auto;
    padding: 20px;
    border-radius: 12px;
    width: 80%;
}

.numeri {
    display: flex;
    justify-content: center;
    gap: 15px;
    margin-top: 15px;
}

.numeri span {
    background: gold;
    color: black;
    font-weight: bold;
    width: 45px;
    height: 45px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
}
</style>
</head>

<body>

<h1>ðŸŽ¯ Lotto Live Statistiche</h1>

<div id="contenitore">
    Caricamento dati...
</div>

<script>

const API_URL = "https://lotto-statistiche.onrender.com/api";

async function caricaDati(retry = 0) {
    try {
        const response = await fetch(API_URL);
        if (!response.ok) throw new Error("Errore server");

        const data = await response.json();
        mostraDati(data);

    } catch (error) {
        if (retry < 5) {
            setTimeout(() => caricaDati(retry + 1), 3000);
        } else {
            document.getElementById("contenitore").innerHTML =
                "<div style='color:yellow;'>Server in avvio... attendi qualche secondo</div>";
        }
    }
}

function mostraDati(data) {

    const contenitore = document.getElementById("contenitore");
    contenitore.innerHTML = "";

    let punteggi = {};

    Object.entries(data).forEach(([ruota, estrazioni]) => {

        const ultima = estrazioni[0];
        const somma = ultima.reduce((a, b) => a + b, 0);
        punteggi[ruota] = somma;

        const blocco = document.createElement("div");
        blocco.className = "ruota";

        blocco.innerHTML = `
            <h2>${ruota}</h2>
            <div class="numeri">
                ${ultima.map(n => `<span>${n}</span>`).join("")}
            </div>
        `;

        contenitore.appendChild(blocco);
    });

    const ruotaTop = Object.keys(punteggi).reduce((a, b) =>
        punteggi[a] > punteggi[b] ? a : b
    );

    const evidenza = document.createElement("div");
    evidenza.style.fontSize = "22px";
    evidenza.style.marginBottom = "20px";
    evidenza.innerHTML = `ðŸ”¥ RUOTA PIÃ™ FORTE: <strong>${ruotaTop}</strong>`;

    contenitore.prepend(evidenza);
}

caricaDati();

</script>

</body>
</html>
